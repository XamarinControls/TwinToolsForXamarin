using System;
using NUnit.Framework;

namespace TwinTechs.EditorExtensions.Helpers
{
	[TestFixture]
	public class XamlHelperTests
	{
		string XamlFileExample = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<ContentPage\n\txmlns=\"http://xamarin.com/schemas/2014/forms\"\n\txmlns:x=\"http://schemas.microsoft.com/winfx/2009/xaml\"\n\txmlns:xlabs=\"clr-namespace:XLabs.Forms.Controls;assembly=XLabs.Forms\"\n\txmlns:controls=\"clr-namespace:Giganet.Core.Controls;assembly=GiganetMobile\"\n\txmlns:xlabsControls=\"clr-namespace:XLabs.Forms.Controls;assembly=XLabs.Forms\"\n\txmlns:converters=\"clr-namespace:Giganet.Core.Xaml.Converters;assembly=GiganetMobile\"\n\txmlns:svg=\"clr-namespace:SVG.Forms.Plugin.Abstractions;assembly=SVG.Forms.Plugin.Abstractions\"\n\tx:Class=\"Selfeo.Account.Login.View.SelfeoLoginPage\"\n\tBackgroundColor=\"#3E2268\">\n\n\t<ContentPage.Resources>\n\n\t\t<ResourceDictionary>\n\n\t\t\t<converters:NegateBooleanConverter\n\t\t\t\tx:Key=\"Inverter\" />\n\n\t\t</ResourceDictionary>\n\n\t</ContentPage.Resources>\n\n\t<StackLayout\n\t\tx:Name=\"CenterLayout\"\n\t\tVerticalOptions=\"Start\"\n\t\tPadding=\"0, 100\"\n\t\tBackgroundColor=\"#3E2268\">\n\t\t<!--TODO: scroll view for short phones -->\n\n\t\t<StackLayout\n\t\t\tx:Name=\"LoginItemsStack\"\n\t\t\tVerticalOptions=\"Start\"\n\t\t\tIsVisible=\"{Binding ShowingLoginOptions}\">\n\n\t\t\t<Image\n\t\t\t\tVerticalOptions=\"Start\"\n\t\t\t\tHorizontalOptions=\"Center\"\n\t\t\t\tBackgroundColor=\"#3E2268\"\n\t\t\t\tAspect=\"AspectFit\"\n\t\t\t\tx:Name=\"LogoImage\"\n\t\t\t\tSource=\"logoSelfeo.png\" />\n\n\t\t\t<controls:ExtendedButton\n\t\t\t\tx:Name=\"FacebookLoginButton\"\n\t\t\t\tHorizontalOptions=\"Center\"\n\t\t\t\tSVGImageRoot=\"Login.btnSignInFacebook\"\n\t\t\t\tImageWidthRequest=\"355\"\n\t\t\t\tImageHeightRequest=\"50\"\n\t\t\t\tWidthRequest=\"246\"\n\t\t\t\tHeightRequest=\"54\"\n\t\t\t\tClicked=\"OnFacebookLoginButtonClicked\" />\n\n\t\t\t<controls:ExtendedButton\n\t\t\t\tx:Name=\"EmailSignInButton\"\n\t\t\t\tHorizontalOptions=\"Center\"\n\t\t\t\tSVGImageRoot=\"Login.btnSignInEmail\"\n\t\t\t\tImageWidthRequest=\"355\"\n\t\t\t\tImageHeightRequest=\"50\"\n\t\t\t\tWidthRequest=\"246\"\n\t\t\t\tHeightRequest=\"54\"\n\t\t\t\tClicked=\"OnEmailSignInButtonClicked\" />\n\n\t\t\t<controls:ExtendedButton\n\t\t\t\tx:Name=\"EmailAccountSignUpButton\"\n\t\t\t\tHorizontalOptions=\"Center\"\n\t\t\t\tSVGImageRoot=\"Login.btnSignUp\"\n\t\t\t\tImageWidthRequest=\"355\"\n\t\t\t\tImageHeightRequest=\"50\"\n\t\t\t\tWidthRequest=\"246\"\n\t\t\t\tHeightRequest=\"54\"\n\t\t\t\tClicked=\"OnEmailAccountSignUpButtonClicked\" />\n\n\t\t</StackLayout>\n\n\t\t<StackLayout\n\t\t\tx:Name=\"EmailSignInStack\"\n\t\t\tVerticalOptions=\"Start\"\n\t\t\tPadding=\"0,0\"\n\t\t\tIsVisible=\"{Binding ShowingEmailLogin}\">\n\n\t\t\t<AbsoluteLayout\n\t\t\t\tHeightRequest=\"140\">\n\n\t\t\t\t<controls:ExtendedButton\n\t\t\t\t\tx:Name=\"EmailSignInBackButton\"\n\t\t\t\t\tSVGImageRoot=\"General.Buttons.iconBack\"\n\t\t\t\t\tImageHeightRequest=\"44\"\n\t\t\t\t\tImageWidthRequest=\"44\"\n\t\t\t\t\tHorizontalOptions=\"Start\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"None\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0,0,44,44\"\n\t\t\t\t\tClicked=\"OnBackButtonClicked\" />\n\n\t\t\t\t<Image\n\t\t\t\t\tVerticalOptions=\"Start\"\n\t\t\t\t\tHorizontalOptions=\"Center\"\n\t\t\t\t\tBackgroundColor=\"#3E2268\"\n\t\t\t\t\tAspect=\"AspectFit\"\n\t\t\t\t\tSource=\"logoSelfeo.png\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"XProportional\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0.5,-15,190,190\" />\n\n\t\t\t</AbsoluteLayout>\n\n\t\t\t<StackLayout\n\t\t\t\tVerticalOptions=\"Start\"\n\t\t\t\tPadding=\"15,0\">\n\n\t\t\t\t<xlabsControls:ExtendedEntry\n\t\t\t\t\tx:Name=\"EmailSignInEmailEntry\"\n\t\t\t\t\tPlaceholder=\"Email\"\n\t\t\t\t\tHorizontalOptions=\"Fill\"\n\t\t\t\t\tBackgroundColor=\"White\"\n\t\t\t\t\tTextColor=\"Black\"\n\t\t\t\t\tFont=\"Small\"\n\t\t\t\t\tText=\"{Binding Email, Mode=TwoWay}\"\n\t\t\t\t\tKeyboard=\"Email\"\n\t\t\t\t\tEnterButtonType=\"Next\"\n\t\t\t\t\tCompleted=\"OnEntryCompleted\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"WidthProportional,YProportional\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0.1,0.5,1,30\" />\n\n\t\t\t\t<xlabsControls:ExtendedEntry\n\t\t\t\t\tx:Name=\"EmailSignInPasswordEntry\"\n\t\t\t\t\tIsPassword=\"true\"\n\t\t\t\t\tPlaceholder=\"Password\"\n\t\t\t\t\tHorizontalOptions=\"Fill\"\n\t\t\t\t\tBackgroundColor=\"White\"\n\t\t\t\t\tTextColor=\"Black\"\n\t\t\t\t\tFont=\"Small\"\n\t\t\t\t\tEnterButtonType=\"Done\"\n\t\t\t\t\tCompleted=\"OnEntryCompleted\"\n\t\t\t\t\tText=\"{Binding Password, Mode=TwoWay}\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"WidthProportional,YProportional\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0.1,0.5,1,30\" />\n\n\t\t\t\t<controls:ExtendedButton\n\t\t\t\t\tx:Name=\"SignInButton\"\n\t\t\t\t\tHorizontalOptions=\"Center\"\n\t\t\t\t\tTextColor=\"#3E2268\"\n\t\t\t\t\tBackgroundColor=\"#FFFFFF\"\n\t\t\t\t\tText=\"Sign In\"\n\t\t\t\t\tWidthRequest=\"246\"\n\t\t\t\t\tHeightRequest=\"54\"\n\t\t\t\t\tClicked=\"OnSignInButtonClicked\" />\n\n\t\t\t\t<controls:ExtendedButton\n\t\t\t\t\tText=\"Reset my password\"\n\t\t\t\t\tTextColor=\"#FFFFFF\"\n\t\t\t\t\tHorizontalOptions=\"Center\"\n\t\t\t\t\tWidthRequest=\"246\"\n\t\t\t\t\tHeightRequest=\"54\"\n\t\t\t\t\tClicked=\"OnStartPasswordResetButtonClicked\" />\n\n\t\t\t</StackLayout>\n\n\t\t</StackLayout>\n\n\t\t<StackLayout\n\t\t\tx:Name=\"PasswordResetStack\"\n\t\t\tVerticalOptions=\"Start\"\n\t\t\tPadding=\"0,0\"\n\t\t\tIsVisible=\"{Binding ShowingPasswordReset}\">\n\n\t\t\t<AbsoluteLayout\n\t\t\t\tHeightRequest=\"170\">\n\n\t\t\t\t<controls:ExtendedButton\n\t\t\t\t\tx:Name=\"PasswordResetBackButton\"\n\t\t\t\t\tSVGImageRoot=\"General.Buttons.iconBack\"\n\t\t\t\t\tImageHeightRequest=\"44\"\n\t\t\t\t\tImageWidthRequest=\"44\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"None\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0,0,44,44\"\n\t\t\t\t\tClicked=\"OnBackButtonClicked\" />\n\n\t\t\t\t<Image\n\t\t\t\t\tVerticalOptions=\"Start\"\n\t\t\t\t\tHorizontalOptions=\"Center\"\n\t\t\t\t\tBackgroundColor=\"#3E2268\"\n\t\t\t\t\tAspect=\"AspectFit\"\n\t\t\t\t\tSource=\"logoSelfeo.png\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"XProportional\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0.5,-10,220,220\" />\n\n\t\t\t</AbsoluteLayout>\n\n\t\t\t<StackLayout\n\t\t\t\tVerticalOptions=\"Start\"\n\t\t\t\tPadding=\"15,0\">\n\n\t\t\t\t<xlabsControls:ExtendedEntry\n\t\t\t\t\tx:Name=\"PasswordResetEmailEntry\"\n\t\t\t\t\tPlaceholder=\"Email\"\n\t\t\t\t\tKeyboard=\"Email\"\n\t\t\t\t\tHorizontalOptions=\"Fill\"\n\t\t\t\t\tBackgroundColor=\"White\"\n\t\t\t\t\tTextColor=\"Black\"\n\t\t\t\t\tFont=\"Small\"\n\t\t\t\t\tText=\"{Binding Email, Mode=TwoWay}\"\n\t\t\t\t\tEnterButtonType=\"Done\"\n\t\t\t\t\tCompleted=\"OnEntryCompleted\"\n\t\t\t\t\tIsVisible=\"{Binding IsCreatingAccountWithFacebook, Converter={StaticResource Inverter}}\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"WidthProportional,YProportional\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0.1,0.5,1,30\" />\n\n\t\t\t\t<controls:ExtendedButton\n\t\t\t\t\tx:Name=\"ResetPasswordButton\"\n\t\t\t\t\tHorizontalOptions=\"Center\"\n\t\t\t\t\tTextColor=\"#3E2268\"\n\t\t\t\t\tBackgroundColor=\"#FFFFFF\"\n\t\t\t\t\tText=\"Reset My Password\"\n\t\t\t\t\tImageWidthRequest=\"246\"\n\t\t\t\t\tImageHeightRequest=\"54\"\n\t\t\t\t\tWidthRequest=\"246\"\n\t\t\t\t\tHeightRequest=\"54\"\n\t\t\t\t\tIsVisible=\"{Binding IsCreatingAccountWithFacebook, Converter={StaticResource Inverter}}\"\n\t\t\t\t\tClicked=\"OnResetPasswordButtonClicked\" />\n\n\t\t\t</StackLayout>\n\n\t\t</StackLayout>\n\n\t\t<StackLayout\n\t\t\tx:Name=\"AccountCreationStack\"\n\t\t\tVerticalOptions=\"Start\"\n\t\t\tPadding=\"0,0\"\n\t\t\tIsVisible=\"{Binding ShowingCreateAccount}\">\n\n\t\t\t<AbsoluteLayout\n\t\t\t\tHeightRequest=\"170\">\n\n\t\t\t\t<controls:ExtendedButton\n\t\t\t\t\tx:Name=\"AccountCreationBackButton\"\n\t\t\t\t\tSVGImageRoot=\"General.Buttons.iconBack\"\n\t\t\t\t\tImageHeightRequest=\"44\"\n\t\t\t\t\tImageWidthRequest=\"44\"\n\t\t\t\t\tHorizontalOptions=\"Start\"\n\t\t\t\t\tClicked=\"OnBackButtonClicked\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"None\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0,0,44,44\" />\n\n\t\t\t\t<Image\n\t\t\t\t\tVerticalOptions=\"Start\"\n\t\t\t\t\tHorizontalOptions=\"Center\"\n\t\t\t\t\tBackgroundColor=\"#3E2268\"\n\t\t\t\t\tAspect=\"AspectFit\"\n\t\t\t\t\tSource=\"logoSelfeo.png\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"XProportional\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0.5,-10,220,220\" />\n\n\t\t\t</AbsoluteLayout>\n\n\t\t\t<StackLayout\n\t\t\t\tVerticalOptions=\"Start\"\n\t\t\t\tPadding=\"15,0\">\n\n\t\t\t\t<xlabsControls:ExtendedEntry\n\t\t\t\t\tx:Name=\"NewAccountNameEntry\"\n\t\t\t\t\tPlaceholder=\"Name\"\n\t\t\t\t\tHorizontalOptions=\"Fill\"\n\t\t\t\t\tBackgroundColor=\"White\"\n\t\t\t\t\tTextColor=\"Black\"\n\t\t\t\t\tFont=\"Small\"\n\t\t\t\t\tText=\"{Binding Name, Mode=TwoWay}\"\n\t\t\t\t\tCompleted=\"OnEntryCompleted\"\n\t\t\t\t\tEnterButtonType=\"Next\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"WidthProportional,YProportional\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0.1,0.5,1,30\" />\n\n\t\t\t\t<xlabsControls:ExtendedEntry\n\t\t\t\t\tx:Name=\"NewAccountEmailEntry\"\n\t\t\t\t\tPlaceholder=\"Email\"\n\t\t\t\t\tKeyboard=\"Email\"\n\t\t\t\t\tHorizontalOptions=\"Fill\"\n\t\t\t\t\tBackgroundColor=\"White\"\n\t\t\t\t\tTextColor=\"Black\"\n\t\t\t\t\tFont=\"Small\"\n\t\t\t\t\tText=\"{Binding Email, Mode=TwoWay}\"\n\t\t\t\t\tCompleted=\"OnEntryCompleted\"\n\t\t\t\t\tEnterButtonType=\"Next\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"WidthProportional,YProportional\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0.1,0.5,1,30\" />\n\n\t\t\t\t<xlabsControls:ExtendedEntry\n\t\t\t\t\tx:Name=\"NewAccountPasswordEntry\"\n\t\t\t\t\tIsPassword=\"true\"\n\t\t\t\t\tPlaceholder=\"Password\"\n\t\t\t\t\tHorizontalOptions=\"Fill\"\n\t\t\t\t\tBackgroundColor=\"White\"\n\t\t\t\t\tTextColor=\"Black\"\n\t\t\t\t\tFont=\"Small\"\n\t\t\t\t\tText=\"{Binding Password, Mode=TwoWay}\"\n\t\t\t\t\tCompleted=\"OnEntryCompleted\"\n\t\t\t\t\tEnterButtonType=\"Next\"\n\t\t\t\t\tIsVisible=\"{Binding ShowingCreateAccountPasswords}\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"WidthProportional,YProportional\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0.1,0.5,1,30\" />\n\n\t\t\t\t<xlabsControls:ExtendedEntry\n\t\t\t\t\tx:Name=\"NewAccountPasswordConfirmEntry\"\n\t\t\t\t\tIsPassword=\"true\"\n\t\t\t\t\tPlaceholder=\"Confirm Password\"\n\t\t\t\t\tHorizontalOptions=\"Fill\"\n\t\t\t\t\tBackgroundColor=\"White\"\n\t\t\t\t\tTextColor=\"Black\"\n\t\t\t\t\tFont=\"Small\"\n\t\t\t\t\tText=\"{Binding PasswordConfirm, Mode=TwoWay}\"\n\t\t\t\t\tEnterButtonType=\"Done\"\n\t\t\t\t\tCompleted=\"OnEntryCompleted\"\n\t\t\t\t\tIsVisible=\"{Binding ShowingCreateAccountPasswords}\"\n\t\t\t\t\tAbsoluteLayout.LayoutFlags=\"WidthProportional,YProportional\"\n\t\t\t\t\tAbsoluteLayout.LayoutBounds=\"0.1,0.5,1,30\" />\n\n\t\t\t\t<controls:ExtendedButton\n\t\t\t\t\tx:Name=\"CreateAccountButton\"\n\t\t\t\t\tHorizontalOptions=\"Center\"\n\t\t\t\t\tTextColor=\"#3E2268\"\n\t\t\t\t\tBackgroundColor=\"#FFFFFF\"\n\t\t\t\t\tText=\"Create Account\"\n\t\t\t\t\tImageWidthRequest=\"246\"\n\t\t\t\t\tImageHeightRequest=\"54\"\n\t\t\t\t\tWidthRequest=\"246\"\n\t\t\t\t\tHeightRequest=\"54\"\n\t\t\t\t\tClicked=\"OnCreateAccountButtonClicked\" />\n\n\t\t\t</StackLayout>\n\n\t\t</StackLayout>\n\n\t\t<StackLayout\n\t\t\tOrientation=\"Horizontal\"\n\t\t\tHorizontalOptions=\"CenterAndExpand\"\n\t\t\tVerticalOptions=\"Center\"\n\t\t\tSpacing=\"0\"\n\t\t\tPadding=\"20,20\"\n\t\t\tIsVisible=\"{Binding ShowingTermsCheckbox}\">\n\n\t\t\t<controls:ExtendedButton\n\t\t\t\tSVGImageRoot=\"General.Controls.checkbox\"\n\t\t\t\tx:Name=\"TermsButton\"\n\t\t\t\tStyleId=\"TermsButton\"\n\t\t\t\tClicked=\"OnToggleTermsClicked\"\n\t\t\t\tImageHeightRequest=\"44\"\n\t\t\t\tImageWidthRequest=\"44\"\n\t\t\t\tWidthRequest=\"44\"\n\t\t\t\tIsSelected=\"{Binding IsTermsAccepted}\" />\n\n\t\t\t<Label\n\t\t\t\tx:Name=\"AcceptLabel\"\n\t\t\t\tText=\"I accept the \"\n\t\t\t\tFontSize=\"12\"\n\t\t\t\tIsEnabled=\"false\"\n\t\t\t\tYAlign=\"Center\"\n\t\t\t\tWidthRequest=\"71\"\n\t\t\t\tLineBreakMode=\"NoWrap\"\n\t\t\t\tTextColor=\"White\" />\n\n\t\t\t<Label\n\t\t\t\tx:Name=\"termsAndConditionsLinkLabel\"\n\t\t\t\tLineBreakMode=\"NoWrap\"\n\t\t\t\tText=\"Terms and Conditions \"\n\t\t\t\tWidthRequest=\"125\"\n\t\t\t\tFontSize=\"12\"\n\t\t\t\tYAlign=\"Center\"\n\t\t\t\tTextColor=\"White\" />\n\n\t\t</StackLayout>\n\n\t\t<ActivityIndicator\n\t\t\tColor=\"Gray\"\n\t\t\tHeightRequest=\"54\"\n\t\t\tVerticalOptions=\"Center\"\n\t\t\tHorizontalOptions=\"Center\"\n\t\t\tIsRunning=\"{Binding IsBusy}\"\n\t\t\tIsVisible=\"{Binding IsBusy}\" />\n\n\t\t<!--\t\t<BoxView\n\t\t\tx:Name=\"BottomShim\"\n\t\t\tHeightRequest=\"200\" />-->\n\t</StackLayout>\n\n</ContentPage>\n";

		[SetUp]
		public void Setup ()
		{
		}

		[TestCase ("            Clicked=\"OnClickHandler\" />", 24, ExpectedResult = "OnClickHandler")]
		[TestCase ("            Clicked=\"OnClickHandler\" />", 23, ExpectedResult = "OnClickHandler")]
		[TestCase ("            Clicked=\"OnClickHandler\" />", 26, ExpectedResult = "OnClickHandler")]
		[TestCase ("Clicked=\"ClickedHandler\"", 12, ExpectedResult = "ClickedHandler")]
		[TestCase ("Clicked=\"ClickedHandler\"", 11, ExpectedResult = "ClickedHandler")]
		[TestCase ("Clicked=\"ClickedHandler\"", 14, ExpectedResult = "ClickedHandler")]
		[TestCase ("Clicked=\"ClickedHandler\"", 30, ExpectedResult = null)]
		[TestCase ("Clicked=\"ClickedHandler\"", 1, ExpectedResult = "Clicked")]
		[TestCase ("Clicked=\"ClickedHandler\"", 0, ExpectedResult = null)]
		[TestCase ("Clicked=\"ClickedHandler\"", 5, ExpectedResult = "Clicked")]
		[TestCase ("Clicked=\"{Binding AValue}\"", 5, ExpectedResult = "Clicked")]
		[TestCase ("Clicked=\"{Binding AValue}\"", 20, ExpectedResult = "AValue")]
		[TestCase ("Clicked=\"{Binding AValue}\"", 30, ExpectedResult = null)]
		[TestCase ("Clicked=\"{Binding AValue,SomeOtherXmalThing}\"", 5, ExpectedResult = "Clicked")]
		[TestCase ("Clicked=\"{Binding AValue,SomeOtherXmalThing}\"", 20, ExpectedResult = "AValue")]
		[TestCase ("Clicked=\"{Binding AValue,SomeOtherXmalThing}\"", 30, ExpectedResult = "SomeOtherXmalThing")]

		public string TestGetWordAtColumn (string text, int column)
		{
			return XamlHelper.GetWordAtColumn (text, column);
		}

		[TestCase ("            Clicked=\"Value1\" Clicked2=\"Value2\"/>", 1, ExpectedResult = false)]
		[TestCase ("            Clicked=\"Value1\" Clicked2=\"Value2\"/>", 4, ExpectedResult = false)]
		[TestCase ("            Clicked=\"Value1\" Clicked2=\"Value2\"/>", 24, ExpectedResult = true)]
		[TestCase ("            Clicked=\"Value1\" Clicked2=\"Value2\"/>", 23, ExpectedResult = true)]
		[TestCase ("            Clicked=\"Value1\" Clicked2=\"Value2\"/>", 26, ExpectedResult = true)]
		[TestCase ("            Clicked=\"Value1\" Clicked2=\"Value2\"/>", 40, ExpectedResult = true)]

		public bool TestGetXamlElement (string text, int column)
		{
			return XamlHelper.GetIsPropertyValue (text, column);
		}

	}
}

